function replace {
    dir_tmp=$(mktemp -d)
    tar -xf $tar_file -C $dir_tmp
    rm -f $dir_tmp/docker-compose.yml
    cd $dir_tmp && rsync -av . $lo_rank_dir
    chown -R 1000:1000 $lo_rank_dir
    rm -rf $dir_tmp
}

function restore {
    tar_file=$2
    rank=$3
    rank=${rank:-$RANK}
    check_restore_all $tar_file
    lo_rank_dir=$LO_DIR/$rank
    cd $lo_rank_dir && docker-compose down 2> /dev/null
    replace
    cd $lo_rank_dir && docker-compose up -d 2> /dev/null
}
